

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#' Calculate the path elements for a given letter
#'
#' These are SVG path specifications taken from flexflex.js.
#' Here they are treated as glue strings and evaluated with the given w/h/sw
#'
#' @param ch chararacter. Must be a-zA-Z
#' @param w,h width and height of character. Default: 1
#' @param sw stroke width. Default: 1
#' @return cahracter vector of SVG path elements
#' @importFrom glue glue
#' @noRd
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
chr_to_path <- function(ch, w = 1, h = 1, sw = 1) {
  ch <- toupper(ch);
  
  path <- switch(
    EXPR = ch, 
    A = ifelse(
      2*w < h,
      "M 0 ${h}
    L 0 ${w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} 0
    A ${w/2} ${w/2} 0 0 1 ${w} ${w/2}
    L ${w} ${h}
    M 0 ${h/2}
    L ${w} ${h/2}",
      "M 0 ${h}
    L 0 ${h/4}
    A ${h/4} ${h/4} 0 0 1 ${h/4} 0
    L ${w-h/4} 0
    A ${h/4} ${h/4} 0 0 1 ${w} ${h/4}
    L ${w} ${h}
    M 0 ${h/2}
    L ${w} ${h/2}"
    ),
    B = ifelse(
      w/2 < h/4,
      "M 0 ${h/2}
    L 0 0
    L ${w/2} 0
    A ${w/2} ${w/2} 0 0 1 ${w} ${w/2}
    L ${w} ${h/2-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h/2}
    L 0 ${h/2}
    M ${w/2} ${h/2}
    A ${w/2} ${w/2} 0 0 1 ${w} ${h/2+w/2}
    L ${w} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    L 0 ${h}
    L 0 ${h/2}",
      "M 0 ${h/2}
    L 0 0
    L ${w-h/4} 0
    A ${h/4} ${h/4} 0 0 1 ${w} ${h/4}
    A ${h/4} ${h/4} 0 0 1 ${w-h/4} ${h/2}
    L 0 ${h/2}
    M ${w-h/4} ${h/2}
    A ${h/4} ${h/4} 0 0 1 ${w} ${3*h/4}
    A ${h/4} ${h/4} 0 0 1 ${w-h/4} ${h}
    L 0 ${h}
    L 0 ${h/2}"
    ),
    C = ifelse(
      w < h,
      "M ${w} 0
    L ${w/2} 0
    A ${w/2} ${w/2} 0 0 0 0 ${w/2}
    L 0 ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${h}
    L ${w} ${h}", 
      "    M ${w} 0
    L ${h/2} 0
    A ${h/2} ${h/2} 0 0 0 0 ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${h/2} ${h}
    L ${w} ${h}"
    ),
    D = ifelse(
      w < h,
      "M 0 ${h/2}
    L 0 0
    L ${w/2} 0
    A ${w/2} ${w/2} 0 0 1 ${w} ${w/2}
    L ${w} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    L 0 ${h}
    L 0 ${h/2}",
      "M 0 ${h/2}
    L 0 0
    L ${w-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w-h/2} ${h}
    L 0 ${h}
    L 0 ${h/2}"
    ),
    E = "M ${w} 0
    L 0 0
    L 0 ${h}
    L ${w} ${h}
    M 0 ${h/2}
    L ${w} ${h/2}"
    ,
    F = "M ${w} 0
    L 0 0
    L 0 ${h}
    M 0 ${h/2}
    L ${w} ${h/2}"
    ,
    G = ifelse(
      w < h,
      "M ${w} 0
    L ${w/2} 0
    A ${w/2} ${w/2} 0 0 0 0 ${w/2}
    L 0 ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${h}
    A ${w/2} ${w/2} 0 0 0 ${w} ${h-w/2}
    L ${w} ${h/2}
    L ${w/2+sw/2} ${h/2}",
      "M ${w} 0
    L ${h/2} 0
    A ${h/2} ${h/2} 0 0 0 0 ${h/2}
    L 0 ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${h/2} ${h}
    L ${w-h/2} ${h}
    A ${h/2} ${h/2} 0 0 0 ${w} ${h/2}
    L ${w/2+sw/2} ${h/2}"
    ),
    H = "M 0 0
    L 0 ${h}
    M ${w} 0
    L ${w} ${h}
    M 0 ${h/2}
    L ${w} ${h/2}",
    I = "M 0 0
    L ${w} 0
    M 0 ${h}
    L ${w} ${h}
    M ${w/2} 0
    L ${w/2} ${h}"
    ,
    J = ifelse(
      w < 2*h,
      "M 0 0
    L ${w} 0
    M ${w/2} 0
    L ${w/2} ${h-w/4}
    A ${w/4} ${w/4} 0 0 1 ${w/4} ${h}
    L 0 ${h}",
      "M 0 0
    L ${w} 0
    M ${w/2} 0
    L ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w/2-h/2} ${h}
    L 0 ${h}"),
    K = ifelse(
      2*w < h,
      "M 0 0
    L 0 ${h}
    M 0 ${h/2}
    A ${w} ${w} 0 0 0 ${w} ${h/2-w}
    L ${w} 0
    M 0 ${h/2}
    A ${w} ${w} 0 0 1 ${w} ${h/2+w}
    L ${w} ${h}",
      "M 0 0
    L 0 ${h}
    M 0 ${h/2}
    L ${w-h/2} ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${w} 0
    L ${w} ${0}
    M ${w-h/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w} ${h}"
    ),
    L = "M 0 0
    L 0 ${h}
    L ${w} ${h}",
    M = ifelse(
      w < h,
      "M 0 ${h}
    L 0 0
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${w/2}
    L ${w/2} ${h}
    M ${w/2} ${w/2}
    A ${w/2} ${w/2} 0 0 1 ${w} 0
    L ${w} ${h}",
      "M 0 ${h}
    L 0 0
    L ${w/2-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w/2} ${h/2}
    L ${w/2} ${h}
    M ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w/2+h/2} 0
    L ${w} 0
    L ${w} ${h}"
    ),
    N = ifelse(
      w < h,
      "M 0 ${h}
    L 0 0
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${w/2} 
    L ${w/2} ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w} ${h}
    L ${w} 0",
      "M 0 ${h}
    L 0 0
    L ${w/2-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${w/2+h/2} ${h} 
    L ${w} ${h}
    L ${w} 0"
    ),
    O = ifelse(
      w < h,
      "M 0 ${w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} 0
    A ${w/2} ${w/2} 0 0 1 ${w} ${w/2}
    L ${w} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    A ${w/2} ${w/2} 0 0 1 0 ${h-w/2}
    L 0 ${w/2}",
      "M 0 ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${h/2} 0
    L ${w-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w-h/2} ${h}
    L ${h/2} ${h}
    A ${h/2} ${h/2} 0 0 1 0 ${h/2}"
    ),
    P = ifelse(
      4*w < h,
      "M 0 ${h}
    L 0 0
    A ${w} ${w} 0 0 1 ${w} ${w}
    L ${w} ${h/2-w}
    A ${w} ${w} 0 0 1 0 ${h/2}
    L 0 ${h/2}",
      "M 0 ${h}
    L 0 0
    L ${w-h/4} 0
    A ${h/4} ${h/4} 0 0 1 ${w} ${h/4}
    A ${h/4} ${h/4} 0 0 1 ${w-h/4} ${h/2}
    L 0 ${h/2}"
    ),
    # Q = "M ${w/2} ${h/2+sw/2}
    # L ${w/2} ${h-sw/2}",
    Q = ifelse(
      w < h,
      "M 0 ${w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} 0
    A ${w/2} ${w/2} 0 0 1 ${w} ${w/2}
    L ${w} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    A ${w/2} ${w/2} 0 0 1 0 ${h-w/2}
    L 0 ${w/2}
    M ${w/2} ${h/2}
    L ${w/2} ${h}",
      "M 0 ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${h/2} 0
    L ${w-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w-h/2} ${h}
    L ${h/2} ${h}
    A ${h/2} ${h/2} 0 0 1 0 ${h/2}
    M ${w/2} ${h/2}
    L ${w/2} ${h}"
    ),
    
    R = ifelse(
      4*w < h,
      "M 0 ${h}
    L 0 0
    A ${w} ${w} 0 0 1 ${w} ${w}
    L ${w} ${h/2-w}
    A ${w} ${w} 0 0 1 0 ${h/2}
    A ${w} ${w} 0 0 1 ${w} ${h/2+w}
    L ${w} ${h}",
      "M 0 ${h}
    L 0 0
    L ${w-h/4} 0
    A ${h/4} ${h/4} 0 0 1 ${w} ${h/4}
    A ${h/4} ${h/4} 0 0 1 ${w-h/4} ${h/2}
    L 0 ${h/2}
    M ${w-h/4} ${h/2}
    A ${h/4} ${h/4} 0 0 1 ${w} ${3*h/4}
    L ${w} ${h}"
    ),
    S = ifelse(
      w < h/2,
      "M ${w} 0
    L ${w/2} 0
    A ${w/2} ${w/2} 0 0 0 0 ${w/2}
    L 0 ${h/2-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${h/2}
    A ${w/2} ${w/2} 0 0 1 ${w} ${h/2+w/2}
    L ${w} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    L 0 ${h}",
      "M ${w} 0
    L ${h/4} 0
    A ${h/4} ${h/4} 0 0 0 0 ${h/4}
    A ${h/4} ${h/4} 0 0 0 ${h/4} ${h/2}
    L ${w-h/4} ${h/2}
    A ${h/4} ${h/4} 0 0 1 ${w} ${3*h/4}
    A ${h/4} ${h/4} 0 0 1 ${w-h/4} ${h}
    L 0 ${h}"
    ),
    T = "M 0 0
    L ${w} 0
    M ${w/2} 0
    L ${w/2} ${h}",
    
    U = ifelse(
      w < h,
      "M 0 0
    L 0 ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${h}
    A ${w/2} ${w/2} 0 0 0 ${w} ${h-w/2}
    L ${w} 0",
      "M 0 0
    L 0 ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${h/2} ${h}
    L ${w-h/2} ${h}
    A ${h/2} ${h/2} 0 0 0 ${w} ${h/2}
    L ${w} 0"
    ),
    V = ifelse(
      w < h,
      "M 0 0
    L 0 ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h}
    M ${w/2} ${h}
    A ${w/2} ${w/2} 0 0 1 ${w} ${h-w/2}
    L ${w} 0",
      "M 0 0
    L 0 ${h/2}
    L ${w/2-h/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w/2} ${h}
    M ${w/2} ${h}
    A ${h/2} ${h/2} 0 0 1 ${w/2+h/2} ${h/2}
    L ${w} ${h/2}
    L ${w} 0"
    ), 
    W = ifelse(
      w < h, 
      "M 0 0
    L 0 ${h}
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${h-w/2}
    L ${w/2} 0
    M ${w/2} ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w} ${h}
    L ${w} 0",
      "M 0 0
    L 0 ${h}
    L ${w/2-h/2} ${h}
    A ${h/2} ${h/2} 0 0 0 ${w/2} ${h/2}
    L ${w/2} 0
    M ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${w/2+h/2} ${h}
    L ${w} ${h}
    L ${w} 0"
    ),
    X = ifelse(
      w < h,
      "M 0 0
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${w/2}
    L ${w/2} ${h-w/2}
    A ${w/2} ${w/2} 0 0 1 0 ${h}
    L 0 ${h}
    M ${w} 0
    A ${w/2} ${w/2} 0 0 0 ${w/2} ${w/2}
    M ${w/2} ${h-w/2}
    A ${w/2} ${w/2} 0 0 0 ${w} ${h}",
      "M 0 0
    L ${w/2-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w/2-h/2} ${h}
    L 0 ${h}
    M ${w} 0
    L ${w/2+h/2} 0
    A ${h/2} ${h/2} 0 0 0 ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 0 ${w/2+h/2} ${h}
    L ${w} ${h}"
    ),
    Y = ifelse(w < h, 
               "    M 0 0
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${w/2}
    L ${w/2} ${h}
    M ${w/2} ${w/2}
    A ${w/2} ${w/2} 0 0 1 ${w} 0",
               "    M 0 0
    L ${w/2-h/2} 0
    A ${h/2} ${h/2} 0 0 1 ${w/2} ${h/2}
    L ${w/2} ${h}
    M ${w/2} ${h/2}
    A ${h/2} ${h/2} 0 0 1 ${w/2+h/2} 0
    L ${w} 0"
    ),
    Z = ifelse(w < h, 
               "    M 0 0
    L ${w} 0
    L ${w} ${h/2-w/2}
    A ${w/2} ${w/2} 0 0 1 ${w/2} ${h/2}
    A ${w/2} ${w/2} 0 0 0 0 ${h/2+w/2}
    L 0 ${h}
    L ${w} ${h}",
               "    M 0 0
    L ${w} 0
    A ${h/2} ${h/2} 0 0 1 ${w-h/2} ${h/2}
    L ${h/2} ${h/2}
    A ${h/2} ${h/2} 0 0 0 0 ${h}
    L ${w} ${h}"
    ),
    
    # Default
    return(NULL)
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Get rid of '$' signs so we can use the path as a glue string
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  path <- gsub("\\$", "", path)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Insert/calculate parameters based upon width and height
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  path <- glue::glue(path)
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Split into a character vector of elements in this path
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  elems <- strsplit(path, "\n")[[1]]
  elems <- trimws(elems)
  
  elems
}

